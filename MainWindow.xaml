<Window x:Class="wpf_remoteexec.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:wpf_remoteexec"
        mc:Ignorable="d"
        Title="Hollen9's Remote Exec Server (.NET 4.0.3, WinXP Compatible, need evaluation)" Height="720" Width="1000">
<Grid Margin="10">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="260"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Settings -->
    <GroupBox Header="Settings" Grid.Row="0" Padding="8" Margin="0,0,0,8">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="160"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="180"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
            </Grid.RowDefinitions>

            <TextBlock Text="Port:" VerticalAlignment="Center"/>
            <TextBox x:Name="PortBox" Grid.Column="1" Text="8087" Margin="6,1"/>

            <TextBlock Text="Password:" Grid.Row="1" VerticalAlignment="Center"/>
            <PasswordBox x:Name="PwdBox" Grid.Column="1" Grid.Row="1" Password="ChangeThisPassword!" Margin="6,1"/>

            <TextBlock Text="Global Timeout (ms):" Grid.Row="2" VerticalAlignment="Center"/>
            <TextBox x:Name="GlobalTimeoutBox" Grid.Column="1" Grid.Row="2" Text="15000" Margin="6,1"/>

            <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" Margin="6,0">
                <CheckBox x:Name="PostOnlyChk" Content="POST only" Margin="0,0,16,0" />
                <CheckBox x:Name="Same24Chk" Content="Only same /24 (255.255.255.0)" />
            </StackPanel>

            <TextBlock Grid.Row="4" Grid.Column="0" Text="Endpoints:" VerticalAlignment="Center"/>
            <TextBlock Grid.Row="4" Grid.Column="1" Text="/run (pwd, cmd) | /list" VerticalAlignment="Center"/>

            <TextBlock Grid.Row="5" Grid.Column="0" Text="Arguments:" VerticalAlignment="Center"/>
                <TextBlock Grid.Row="5" Grid.Column="1" Text="--autostart | --autostart:force | --minimized" VerticalAlignment="Center"/>
        </Grid>
    </GroupBox>

    <!-- Commands -->
    <GroupBox Header="Commands" Grid.Row="1" Padding="8" Margin="0,0,0,8">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <DataGrid x:Name="CmdGrid" Grid.Row="0" AutoGenerateColumns="False" CanUserAddRows="False"
                          ItemsSource="{Binding Commands}" HeadersVisibility="Column" IsReadOnly="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Name" Binding="{Binding Name, UpdateSourceTrigger=PropertyChanged}" Width="150"/>
                    <DataGridTextColumn Header="File / BAT Path" Binding="{Binding FilePath, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                    <DataGridTemplateColumn Header="Browse" Width="90">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="Browse..." Padding="4,2" Click="BrowseRow_Click" Tag="{Binding}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn Header="Arguments" Binding="{Binding Arguments, UpdateSourceTrigger=PropertyChanged}" Width="220"/>
                    <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding Enabled}" Width="70"/>

                    <!-- New: per-command options -->
                    <DataGridTextColumn Header="Custom Timeout (ms)" Binding="{Binding TimeoutMs, UpdateSourceTrigger=PropertyChanged}" Width="150"/>
                    <DataGridCheckBoxColumn Header="No Response" Binding="{Binding NoResponse}" Width="100"/>
                    <DataGridCheckBoxColumn Header="Hide Window" Binding="{Binding HideWindow}" Width="100"/>
                </DataGrid.Columns>
            </DataGrid>

            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                <Button Content="Add" Width="90" Margin="0,0,8,0" Click="AddCmd_Click"/>
                <Button Content="Remove Selected" Width="140" Margin="0,0,8,0" Click="RemoveCmd_Click"/>
                <Button Content="Save" Width="90" Click="SaveCmd_Click"/>
            </StackPanel>
        </Grid>
    </GroupBox>

    <!-- Log -->
    <GroupBox Header="Log" Grid.Row="2">
        <Grid>
            <TextBox x:Name="LogBox" FontFamily="Consolas" FontSize="12"
                         TextWrapping="NoWrap" VerticalScrollBarVisibility="Auto"
                         HorizontalScrollBarVisibility="Auto" AcceptsReturn="True"
                         IsReadOnly="True"/>
        </Grid>
    </GroupBox>

    <!-- Control -->
    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
        <Button x:Name="StartBtn" Content="Start" Width="90" Margin="0,0,8,0" Click="StartBtn_Click"/>
        <Button x:Name="StopBtn" Content="Stop" Width="90" IsEnabled="False" Click="StopBtn_Click"/>
    </StackPanel>
</Grid>
</Window>